<a href="Home.md"><img align="left" width="80" height="80" src="../Images/logo_Z4D.png" alt="Logo"></a>

# HowTo - Build a good ZigBee mesh network

</br>

## Best practices for optimizing reception and transmission to improve ZigBee network range and coverage

Both poor signal quality and signal interference can lead to transmission errors and related issues.  This section contains fundamental troubleshooting tips on how to improve signal quality plus optimize range and coverage. Improving signal quality and removing sources of signal interference can in most cases maximize range and resolves problems related to transmission errors. Please try to follow at least some of these recommendations before posting on the community forums or reporting issues to developers.

1. Adding more ZigBee routers between devices far away and the next closest router or your ZigBee coordinator. ZigBee network topology uses a "mesh network" design which means that each device that acts as a ZigBee router will extend the total range and coverage of your ZigBee network as a whole. The solution is to distribute more ZigBee routers in areas with poor reception. Note that while there are exceptions, understand that almost all permanently powered devices will serve as a ZigBee router. Thus adding more permanently powered ZigBee devices will allow greater range better coverage. There are also dedicated ZigBee routers which you can [find by doing a community search for "ZigBee signal repeater" or "ZigBee range extender"](https://community.home-assistant.io/t/advice-on-zigbee-range-extending/175882/)) (an example being IKEA Tradfri Signal Repeater). Devices that can not act as routers are typically battery-operated and known as "end devices". There are some exceptions as some end devices (e.g. Xiaomi/Aqara devices) have issues connecting through routers that are not from the same manufacturer.
2. Use a long USB extension cable with your ZigBee coordinator adapter. This not only enables you to position the ZigBee coordinator adapter for better signal quality, but it also allows you to locate the ZigBee coordinator further away from Wi-Fi access-points/routers or other sources of 2.4GHz signals to avoid signal interference. Optimally in the best area in your home depending on your building's floorplan. Ideally, you want to place the ZigBee coordinator somewhere in the middle of your house/apartment. Building materials influence signal quality, for example, dense/thick concrete, bricks, masonry, etc. dampen all wireless signals. Place the ZigBee coordinator with some distance from walls, ceilings and floors. Also, try different orientations of your ZigBee antenna (or your whole ZigBee coordinator adapter if it has an internal antenna). Some Antennas have a stronger signal in a certain direction. Simply changing orientation can improve signal quality already. Note: A bad USB extension cable may lead to connection issues between the system and the ZigBee coordinator adapter, symptoms of this are disconnection messages.
3. Shield your computer and USB devices or peripherals connected to computers as well as other appliances or cables/wires located close to your ZigBee Coordinator. As already established, ZigBee radio can be very susceptible to electromagnetic interference (EMI, also called radio-frequency interference or RFI), and one very common source that generates electromagnetic fields is unshielded computers and unshielded peripherals so make sure that you use for example enclosures for external hard drives and single-board-computers that are made of metal instead of plastic. Especially known to have a huge interference impact on wireless devices using radio frequency like ZigBee radios are USB 3.0 devices/peripherals (for more details on that read white paper report on the subject by Intel at https://www.usb.org/sites/default/files/327216.pdf).
4. ZigBee and Wi-Fi can operate on various channels in the 2.4GHz spectrum. A busy Wi-Fi access-points/routers that are operating in the same frequency range (overlapping channels) as your ZigBee coordinator will drown out the ZigBee traffic, especially if they are located close to each other. To avoid interference between ZigBee and Wi-Fi try to choose channels without overlap. Check the channel your Wi-Fi access-points/routers are using (either by checking on the router's web interface or using a Wi-Fi analyzer app). The ZigBee channel is currently not shown in the Home Assistant front-end but you can find the channel in the logs (watch out for Network parameters log entry with the channel number, e.g., `radioChannel=15`). Changing the channel of the ZigBee network needs recreating it and re-join/re-pair all of your ZigBee devices. Typically it's a lot easier to change the channel used by your Wi-Fi. See [this article for Wi-Fi and ZigBee channels coexistance](https://www.metageek.com/training/resources/zigbee-wifi-coexistence.html) to avoid using overlapping frequency ranges.
5. Check if updating the firmware on your ZigBee coordinator adapter and your ZigBee end devices is possible. Note that depending on your hardware the latest ZigBee coordinator firmware might not always be the one recommended by the community so it is advised to ask before upgrading.
6. If your ZigBee coordinator adapter has a removable antenna (e.g., with an SMA-connector) then you have the option of replacing it with a high-gain antenna. Note that antennas with higher gain usually have directionality: You might have better reception on the same floor, but reception across floors might suffer. In addition, you also have the option to use an antenna extension cable if needed (usually using just a USB extension cable for your ZigBee coordinator adapter is the better alternative). This should really only be needed if you are trying to cover a long distance, like to another building or very dense/thick walls, ceilings and floors.
7. Buy more powerful ZigBee radio hardware with a better radio range, preferably with an external antenna and based on a newer chip that offers up-to-date firmware. If you are not only experimenting with ZigBee but want a permanently stable and healthy ZigBee mesh network with potentially many devices then you should consider upgrading to a more powerful and newer ZigBee coordinator USB adapter or Ethernet to serial gateway/bridge. Generally, ZigBee adapters with an external antenna will have a better range and offer you more flexibility, therefore you will also want to avoid buying an internal ZigBee adapter unless it has a port for an external antenna.

Troubleshooting ? Have a look to [Best practices to avoid pairing/connection difficulties](Troubleshooting_Pairing.md)

Written by [@Hedda](https://github.com/Hedda)
